(()=>{"use strict";var e=document.querySelector("canvas"),i=document.querySelector("#scoreEl"),t=document.querySelector("#coinEl"),n=document.querySelector("#heartEl"),o=document.querySelector(".level"),s=document.querySelector(".bg"),a=document.querySelector(".win"),g=document.querySelector("#scoreWin"),r=document.querySelector("#coinWin"),m=document.querySelector("#heartWin"),h=document.querySelector(".restart"),l=document.URL;function y(e){var i=new Image;return i.src=l+e,i.onload=function(){console.log("imageLoad")},i}var x=y("static/level_1/platform.png"),p=y("static/level_1/player.png"),w=y("static/level_1/playerLeft.png"),c=y("static/level_1/playerCollisionLeft.png"),u=y("static/level_1/playerCollisionRight.png"),f=y("static/level_1/background.png"),d=y("static/level_1/platformSmall.png"),v=y("static/level_1/platformMini.png"),P=y("static/level_1/stone.png"),_=y("static/level_1/unit.png"),S=y("static/level_1/boss.png"),L=y("static/level_1/bossRight.png"),R=y("static/level_1/win.png"),M=y("static/level_1/winMountain.png"),T=y("static/level_2/platform.png"),E=y("static/level_2/player.png"),H=y("static/level_2/playerLeft.png"),b=y("static/level_2/playerCollisionLeft.png"),k=y("static/level_2/playerCollisionRight.png"),I=y("static/level_2/background.png"),q=y("static/level_2/platformSmall.png"),C=y("static/level_2/platformMini.png"),W=y("static/level_2/stone.png"),j=y("static/level_2/unit.png"),O=y("static/level_2/boss.png"),A=y("static/level_2/win.png"),F=y("static/level_2/winMountain.png"),N=y("static/level_3/platform.png"),U=y("static/level_3/player.png"),z=y("static/level_3/playerLeft.png"),B=y("static/level_3/playerCollisionLeft.png"),D=y("static/level_3/playerCollisionRight.png"),G=y("static/level_3/background.png"),J=y("static/level_3/platformSmall.png"),K=y("static/level_3/platformMini.png"),Q=y("static/level_3/stone.png"),V=y("static/level_3/unit.png"),X=y("static/level_3/unitRight.png"),Y=y("static/level_3/boss.png"),Z=y("static/level_3/bossRight.png"),$=y("static/level_3/win.png"),ee=y("static/level_3/winMountain.png");function ie(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function te(e,i){for(var t=0;t<i.length;t++){var n=i[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ne(e,i,t){return i&&te(e.prototype,i),t&&te(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}var oe=e.getContext("2d");e.width=1024,e.height=590;var se,ae,ge=0,re=0,me=100,he=!1,le=0,ye=function(){function e(i){var t=i.x,n=i.y,o=i.image;ie(this,e),this.position={x:t,y:n},this.image=o,this.width=o.width,this.height=o.height}return ne(e,[{key:"draw",value:function(){oe.drawImage(this.image,this.position.x,this.position.y,this.width,this.height)}}]),e}(),xe=function(){function e(i){var t=i.x,n=i.y,o=i.image;ie(this,e),this.position={x:t,y:n},this.image=o,this.width=o.width,this.height=o.height}return ne(e,[{key:"draw",value:function(){oe.drawImage(this.image,this.position.x,this.position.y)}}]),e}(),pe=function(){function i(e){var t=e.image,n=e.imageleft,o=e.collisionRight,s=e.collisionLeft;ie(this,i),this.speed=10,this.position={x:100,y:100},this.movement={x:0,y:0},this.width=80,this.height=80,this.image=t,this.frames=0,this.sprites={right:t,left:n,collision:{right:o,left:s}},this.currentSprite=this.sprites.right}return ne(i,[{key:"draw",value:function(){this.currentSprite!==this.sprites.collision.right&&this.currentSprite!==this.sprites.collision.left?oe.drawImage(this.currentSprite,this.position.x,this.position.y,this.width,this.height):oe.drawImage(this.currentSprite,175*this.frames,0,171,175,this.position.x,this.position.y,this.width,this.height)}},{key:"update",value:function(){this.currentSprite!==this.sprites.collision.right&&this.currentSprite!==this.sprites.collision.left||(this.frames++,this.frames>15&&(this.frames=0)),this.draw(),this.position.x+=this.movement.x,this.position.y+=this.movement.y,this.position.y+this.height+this.movement.y<=e.height&&(this.movement.y+=1.8)}}]),i}(),we=function(){function e(i){var t=i.x,n=i.y;ie(this,e),this.position={x:t,y:n},this.width=35,this.height=35,this.image=y("static/coin.png")}return ne(e,[{key:"draw",value:function(){oe.drawImage(this.image,this.position.x,this.position.y,this.width,this.height)}}]),e}(),ce=function(){function e(i){var t=i.x,n=i.y,o=i.image;ie(this,e),this.position={x:t,y:n},this.width=80,this.height=60,this.image=o}return ne(e,[{key:"draw",value:function(){oe.drawImage(this.image,this.position.x,this.position.y,this.width,this.height)}}]),e}(),ue=function(){function e(i){var t=i.x,n=i.y,o=i.maxPos,s=i.minPos,a=i.image,g=i.imageRight;ie(this,e),this.speed=2,this.position={x:t,y:n},this.maxPos=o,this.minPos=s,this.image=a,this.width=a.width,this.height=a.height,this.sprites={left:a,right:g},this.currentSprite=this.sprites.left}return ne(e,[{key:"draw",value:function(){oe.drawImage(this.currentSprite,this.position.x,this.position.y,this.width,this.height)}},{key:"update",value:function(){this.draw(),this.position.x>this.maxPos?(this.currentSprite=this.sprites.left,this.speed=-this.speed):this.position.x<this.minPos&&(this.currentSprite=this.sprites.right,this.speed=-this.speed),this.position.x+=this.speed}}]),e}(),fe={right:{pressed:!1},left:{pressed:!1},top:{pressed:!1}},de=1;window.localStorage.getItem("level")&&(de=Number(window.localStorage.getItem("level")));var ve=[],Pe=[],_e=[],Se=[],Le=[],Re={1:{init:function(){ae=new pe({image:p,imageleft:w,collisionLeft:c,collisionRight:u}),Pe=[new xe({x:-1,y:-1,image:f}),new xe({x:7240,y:300,image:R}),new xe({x:7260,y:300,image:M})],ve=[new ye({x:2273,y:400,image:v}),new ye({x:4820,y:400,image:v}),new ye({x:8524,y:400,image:v}),new ye({x:8778,y:350,image:v}),new ye({x:9030,y:300,image:v}),new ye({x:9320,y:350,image:v}),new ye({x:10067,y:350,image:v}),new ye({x:4008,y:450,image:d}),new ye({x:5736,y:450,image:d}),new ye({x:5987,y:450,image:d}),new ye({x:-1,y:500,image:x}),new ye({x:565,y:500,image:x}),new ye({x:1230,y:500,image:x}),new ye({x:1998,y:500,image:x}),new ye({x:2664,y:500,image:x}),new ye({x:3330,y:500,image:x}),new ye({x:4153,y:500,image:x}),new ye({x:5070,y:500,image:x}),new ye({x:6240,y:500,image:x}),new ye({x:6806,y:500,image:x}),new ye({x:7552,y:500,image:x}),new ye({x:8250,y:500,image:x}),new ye({x:8816,y:500,image:x}),new ye({x:9382,y:500,image:x}),new ye({x:10350,y:500,image:x})],_e=[new we({x:600,y:450}),new we({x:820,y:450}),new we({x:1700,y:450}),new we({x:2330,y:350}),new we({x:2800,y:450}),new we({x:3500,y:450}),new we({x:3940,y:350}),new we({x:4875,y:350}),new we({x:5795,y:400}),new we({x:6045,y:400}),new we({x:8850,y:450}),new we({x:9e3,y:450}),new we({x:9150,y:450}),new we({x:9300,y:450}),new we({x:9450,y:450})],Se=[new ce({x:700,y:443,image:P}),new ce({x:3e3,y:443,image:P}),new ce({x:7e3,y:443,image:P})],Le=[new ue({x:1700,y:443,maxPos:1750,minPos:1250,image:_,imageRight:_}),new ue({x:2450,y:443,maxPos:2500,minPos:2e3,image:_,imageRight:_}),new ue({x:4450,y:443,maxPos:4650,minPos:4180,image:_,imageRight:_}),new ue({x:6450,y:443,maxPos:6940,minPos:6250,image:_,imageRight:_}),new ue({x:8450,y:443,maxPos:9100,minPos:8250,image:_,imageRight:_}),new ue({x:9800,y:408,maxPos:9850,minPos:9300,image:S,imageRight:L})],ge=0,i.innerHTML=ge,re=0,t.innerHTML=re,me=100,n.innerHTML=me,se=setInterval((function(){ge+=10,i.innerHTML=ge}),1e4),le=0}},2:{init:function(){ae=new pe({image:E,imageleft:H,collisionLeft:b,collisionRight:k}),Pe=[new xe({x:-2,y:-1,image:I}),new xe({x:7230,y:300,image:A}),new xe({x:7260,y:300,image:F})],ve=[new ye({x:2804,y:400,image:C}),new ye({x:3262,y:350,image:C}),new ye({x:6318,y:350,image:C}),new ye({x:7275,y:350,image:C}),new ye({x:9228,y:350,image:C}),new ye({x:1452,y:450,image:q}),new ye({x:1752,y:450,image:q}),new ye({x:6070,y:450,image:q}),new ye({x:6573,y:450,image:q}),new ye({x:6973,y:450,image:q}),new ye({x:-1,y:500,image:T}),new ye({x:650,y:500,image:T}),new ye({x:2053,y:500,image:T}),new ye({x:3059,y:500,image:T}),new ye({x:3709,y:500,image:T}),new ye({x:4566,y:500,image:T}),new ye({x:5217,y:500,image:T}),new ye({x:7600,y:500,image:T}),new ye({x:8435,y:500,image:T}),new ye({x:9500,y:500,image:T}),new ye({x:10340,y:500,image:T})],_e=[new we({x:900,y:450}),new we({x:1e3,y:450}),new we({x:1100,y:450}),new we({x:1510,y:400}),new we({x:1810,y:400}),new we({x:2860,y:350}),new we({x:3320,y:300}),new we({x:4450,y:300}),new we({x:6130,y:400}),new we({x:6375,y:300}),new we({x:6630,y:400}),new we({x:7030,y:400}),new we({x:7330,y:300}),new we({x:9285,y:300})],Se=[new ce({x:760,y:444,image:W}),new ce({x:3800,y:444,image:W}),new ce({x:5500,y:444,image:W}),new ce({x:7900,y:444,image:W})],Le=[new ue({x:2450,y:443,maxPos:2650,minPos:2050,image:j,imageRight:j}),new ue({x:3150,y:443,maxPos:3750,minPos:3060,image:j,imageRight:j}),new ue({x:4e3,y:443,maxPos:4300,minPos:3890,image:j,imageRight:j}),new ue({x:4700,y:443,maxPos:5400,minPos:4560,image:j,imageRight:j}),new ue({x:8600,y:443,maxPos:9e3,minPos:8450,image:j,imageRight:j}),new ue({x:9600,y:408,maxPos:10050,minPos:9500,image:O,imageRight:j})],me=100,n.innerHTML=me,se=setInterval((function(){ge+=10,i.innerHTML=ge}),1e4),le=0}},3:{init:function(){ae=new pe({image:U,imageleft:z,collisionLeft:B,collisionRight:D}),Pe=[new xe({x:-16,y:-17,image:G}),new xe({x:7220,y:300,image:$}),new xe({x:7250,y:300,image:ee})],ve=[new ye({x:753,y:350,image:K}),new ye({x:1024,y:400,image:K}),new ye({x:2709,y:350,image:K}),new ye({x:3009,y:300,image:K}),new ye({x:3360,y:300,image:K}),new ye({x:5917,y:400,image:K}),new ye({x:6169,y:350,image:K}),new ye({x:6419,y:300,image:K}),new ye({x:6529,y:300,image:K}),new ye({x:2107,y:450,image:J}),new ye({x:2410,y:450,image:J}),new ye({x:3710,y:450,image:J}),new ye({x:4816,y:450,image:J}),new ye({x:6870,y:450,image:J}),new ye({x:8726,y:450,image:J}),new ye({x:8976,y:450,image:J}),new ye({x:9229,y:450,image:J}),new ye({x:-1,y:500,image:N}),new ye({x:1305,y:500,image:N}),new ye({x:4012,y:500,image:N}),new ye({x:5116,y:500,image:N}),new ye({x:7172,y:500,image:N}),new ye({x:7974,y:500,image:N}),new ye({x:9500,y:500,image:N}),new ye({x:10332,y:500,image:N})],_e=[new we({x:810,y:300}),new we({x:1080,y:350}),new we({x:2165,y:400}),new we({x:2465,y:400}),new we({x:2765,y:300}),new we({x:3065,y:250}),new we({x:3415,y:250}),new we({x:3765,y:400}),new we({x:4875,y:400}),new we({x:5975,y:350}),new we({x:6225,y:300}),new we({x:6455,y:250}),new we({x:6600,y:250}),new we({x:6928,y:400}),new we({x:8785,y:400}),new we({x:9030,y:400}),new we({x:9285,y:400})],Se=[new ce({x:1750,y:442,image:Q}),new ce({x:8300,y:442,image:Q})],Le=[new ue({x:1500,y:443,maxPos:1680,minPos:1300,image:V,imageRight:X}),new ue({x:4100,y:443,maxPos:4570,minPos:4e3,image:V,imageRight:X}),new ue({x:5350,y:443,maxPos:5700,minPos:5100,image:V,imageRight:X}),new ue({x:7300,y:443,maxPos:7750,minPos:7200,image:V,imageRight:X}),new ue({x:9800,y:380,maxPos:10050,minPos:9500,image:Y,imageRight:Z})],me=100,n.innerHTML=me,se=setInterval((function(){ge+=10,i.innerHTML=ge}),1e4),le=0}}};function Me(e,i,t){if(e.position.x+e.width-10>=i.position.x&&e.position.x+e.width<=i.position.x+i.width&&e.position.y+e.height>=i.position.y)e.currentSprite=e.sprites.collision.right,setTimeout((function(){e.currentSprite=e.sprites.right}),2e3),"stone"===t?e.position.x-=30:"unit"===t&&(i.image===_||i.image===j||i.image===V?(e.position.x-=80,me-=20,n.innerHTML=me):i.image!==S&&i.image!==O&&i.image!==Y||(e.position.x-=80,me-=50,n.innerHTML=me));else{if(!(e.position.x+10<=i.position.x+i.width&&e.position.x>i.position.x&&e.position.y+e.height>=i.position.y))return!1;e.currentSprite=e.sprites.collision.left,setTimeout((function(){e.currentSprite=e.sprites.left}),3e3),"stone"===t?e.position.x+=30:"unit"===t&&(i.image===_||i.image===j||i.image===V?(e.position.x+=80,me-=20,n.innerHTML=me):i.image!==S&&i.image!==O&&i.image!==Y||(e.position.x+=80,me-=50,n.innerHTML=me))}}function Te(e,t,n){e.position.x>t.position.x+t.width&&e.position.x<t.position.x+t.width+11&&fe.right.pressed&&("stone"===n?ge+=10:"unit"===n&&(ge+=30),i.innerHTML=ge)}function Ee(){he||(requestAnimationFrame(Ee),oe.fillStyle="black",oe.fillRect(0,0,e.width,e.height),function(){Pe.forEach((function(e){e.draw()})),ve.forEach((function(e){e.draw()}));for(var e=_e.length-1;e>=0;e--){var i=_e[e];i.draw(),Math.hypot(i.position.x-ae.position.x,i.position.y-ae.position.y)<i.width/2+ae.width/2&&(_e.splice(e,1),re+=10,t.innerHTML=re)}Se.forEach((function(e){e.draw(),Me(ae,e,"stone"),Te(ae,e,"stone")})),Le.forEach((function(e){e.update(),Me(ae,e,"unit"),Te(ae,e,"unit")}))}(),ae.update(),fe.right.pressed&&ae.position.x<400?ae.movement.x=ae.speed:fe.left.pressed&&ae.position.x>100||fe.left.pressed&&0===le&&ae.position.x>0?ae.movement.x=-ae.speed:(ae.movement.x=0,fe.right.pressed?(le+=1)<Pe[0].position.x+Pe[0].width-350?(ve.forEach((function(e){e.position.x-=ae.speed})),Pe.forEach((function(e){e.position.x-=.66*ae.speed})),_e.forEach((function(e){e.position.x-=ae.speed})),Se.forEach((function(e){e.position.x-=ae.speed})),Le.forEach((function(e){e.position.x-=ae.speed,e.minPos-=ae.speed,e.maxPos-=ae.speed}))):le>Pe[0].position.x+Pe[0].width-350&&(ae.movement.x=ae.speed):fe.left.pressed&&le>0&&(le-=1,ve.forEach((function(e){e.position.x+=ae.speed})),Pe.forEach((function(e){e.position.x+=.66*ae.speed})),_e.forEach((function(e){e.position.x+=ae.speed})),Se.forEach((function(e){e.position.x+=ae.speed})),Le.forEach((function(e){e.position.x+=ae.speed,e.minPos+=ae.speed,e.maxPos+=ae.speed})))),ve.forEach((function(e){ae.position.y+ae.height<=e.position.y&&ae.position.y+ae.height+ae.movement.y>=e.position.y&&ae.position.x+ae.width>=e.position.x&&ae.position.x<=e.position.x+e.width&&(ae.movement.y=0)})),(ae.position.y>e.height||0===me)&&(clearInterval(se),Re[de].init()),ae.position.x+ae.width>=Pe[2].position.x&&0===ae.movement.y&&de<=3&&function(){if(3===de)return he=!0,g.innerHTML=ge,r.innerHTML=re,m.innerHTML=me,s.style.opacity=1,a.style.opacity=1,window.localStorage.removeItem("level"),!0;he=!0,de++,s.style.opacity=1,o.innerHTML="level ".concat(de),window.localStorage.setItem("level",de),setTimeout((function(){o.innerHTML="",s.style.opacity=0,he=!1,Re[de].init(),Ee()}),2e3)}())}window.onload=function(){console.log("onload"),Re[de].init(),Ee()},addEventListener("keydown",(function(e){var i=e.keyCode;if(65===i||37===i)fe.left.pressed=!0,ae.currentSprite=ae.sprites.left;else if(68===i||39===i)fe.right.pressed=!0,ae.currentSprite=ae.sprites.right;else if(87===i||38===i){if(event.repeat)return;fe.top.pressed=!0,ae.movement.y-=25}})),addEventListener("keyup",(function(e){var i=e.keyCode;65===i||37===i?fe.left.pressed=!1:68===i||39===i?fe.right.pressed=!1:87!==i&&38!==i||(fe.top.pressed=!1)})),h.addEventListener("click",(function(){de=1,he=!1,o.innerHTML="",s.style.opacity=0,a.style.opacity=0,Re[de].init(),Ee()}))})();